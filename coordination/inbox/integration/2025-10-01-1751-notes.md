# Integration Notes – Dashboard Polaris v12 Migration
Date: 2025-10-01 17:51 UTC
Owner: Agent Mode (Warp)

Progress
- Completed Polaris v12 updates across inbox, sales, seo (structure + props), index, and settings routes.
- Reduced TypeScript error count materially; remaining issues are non-Polaris.

Cross-team impacts and owners
- SEO adapters (owner: SEO/Analytics)
  • ga4Client/gscClient/bingClient type signatures differ from current call sites; need adapter/wrapper or updated client types.
- Webhooks (owner: Shopify integration)
  • App config requires callback-based handlers; current registration uses DeliveryMethod/callbackUrl only. Define HttpWebhookHandlerWithCallback per topic.
- Prisma/DB (owner: Backend)
  • JSON typing mismatches (InputJsonValue, NullableJsonNullValueInput) for payload/metadata fields. Add canonical conversion helpers.
  • ProductVelocityRecord missing recordedFor in in-memory path.
- Mocks/Tests (owner: Tooling)
  • faker.* API usage and literal unions causing TS errors; update factories and test helpers (event stream, afterAll, fetchMock globals).
- Build/Tooling (owner: Tooling)
  • vitest.config.ts plugin typing adjustments (defineConfig, Plugin types, hmr property removal).
- Dashboard UI (owner: Dashboard)
  • Polaris v12 structural changes verified; further QA suggested post-build green.

Risks
- Adapters and webhook changes can ripple into loaders/actions; coordinate merges.
- Test harness updates might mask regressions if not paired with assertions review.

Mitigations
- Land changes in small, verifiable PRs per area (SEO adapters → tests → webhooks → prisma JSON adapters → vitest config).
- Run tsc + unit suites after each area merges.

Next steps (proposed)
1) Implement SEO client adapters/wrappers to align signatures; refactor call sites in app.seo.tsx.
2) Provide webhook callback map with stubs; align app config type expectations.
3) Add jsonValue() helpers to coerce to Prisma InputJsonValue; supply recordedFor where required.
4) Update mocks/tests for stricter typing and remove deprecated faker options.
5) Fix vitest.config.ts plugin typings via proper defineConfig plugin structure.

Check-ins
- Next check-in: 2025-10-01 20:00 UTC (or sooner upon SEO adapter patch).
- Please flag credential or schema changes that could affect adapters.

---

## Manager updates summary (2025-10-01T17:51Z)
- GO-SIGNAL: 5-minute polling active; proof-of-work heartbeat required every cycle
- CEO Directive: Production TODAY; read Production Today + CEO Dependencies + Manager/Integration notes each cycle
- Critical path (DOING): Tooling (Docker/CI/health/alerts), Dashboard (MCP/live/CSP/error boundaries), MCP (rate-limit/retry/SLO dashboards)
- Decisions requested: Approve UI test lane path (A install devDeps / B alias+jsdom / C skip UI suites); confirm Cloudflare tunnel URL vs application_url and approve fix window
- Blockers: Bing credential pending (SEO), Dashboard tunnel/app.toml validation (Dashboard), UI test env devDeps (Tooling), Approvals SSE reachability (Approvals)

## Actions queued next
- Run dashboard TypeScript compile (-p dashboard/tsconfig.json) to surface remaining v12 issues
- Prepare targeted patches for app._index.tsx and app.settings.tsx if compile surfaces errors outside scanned ranges
- Update this note with results and escalate new blockers to blockers-log
