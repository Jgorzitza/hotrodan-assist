# Task backlog (owned by Manager). Status: TODO|DOING|DONE. Each task must reference a node id from rpg.json.

sprint_start: 2025-09-28
sprint_goal: "Ship first navigable Shopify Admin dashboard backed by live RAG + Approvals loop for CS, with mock data toggles removed."

tasks:
  - id: repo.cleanup
    node: tooling
    title: "Clean branches and archive legacy direction files"
    status: DONE
    deliverables:
      - "main ← merge of chore/repo-canonical-layout (fast-forward if possible)"
      - "archive/ moved: HANDOVER*.md, any obsolete agent direction files"
      - "README updated; no conflict markers"
    notes: "Follow commands in `commands/cleanup-and-merge.md`. Completed 2025-10-02 via merge commit 020c3b18 on main."

  - id: cleanup.canonicalization-phase1
    node: tooling
    title: "Inventory instruction surfaces and archive legacy handovers"
    status: DONE
    deliverables:
      - "Published docs/cleanup/inventory-20251002.md"
      - "handover/, AGENT_COMMANDS.md, work orders moved to archive/legacy/"
      - "Created supporting doc placeholders (COMPONENTS, PATTERNS, TROUBLESHOOTING, ARCHITECTURE, DECISIONS)"
    notes: "Completed 2025-10-02; see docs/cleanup/inventory-20251002.md and archive/legacy/."

  - id: cleanup.policy-guardrails
    node: tooling
    title: "Align README, CODEOWNERS, workflows, and PR template with canonical doc set"
    status: DONE
    deliverables:
      - "README references docs/NORTH_STAR.md and repo structure"
      - "CODEOWNERS + verify-managed-files guard new canonical files"
      - "Pull request template enforces molecular scope & artifacts"
      - "agent_launch_commands.md contains GO gate note"
    notes: "Completed 2025-10-02 alongside canonicalization efforts."

  - id: dashboard.settings-v1
    node: dashboard
    title: "Settings screen for credentials vault + feature flags"
    status: TODO
    deliverables:
      - "Polaris form with ENV key presence checks (no values shown)"
      - "Feature toggles: MCP_FORCE_MOCKS, ENABLE_MCP, ENABLE_SEO, ENABLE_INVENTORY"
      - "Health panel that pings each backend service"
      - "Remove MCP_FORCE_MOCKS toggle usage in routes/components once live data paths exist"
      - "Integrate live MCP connector data with graceful fallbacks"
      - "Ensure real-time updates and caching paths are wired"
      - "Surface actionable error handling for live data failures"
    deps: ["tooling.remix-tests"]

  - id: approvals.loop-v1
    node: approvals
    title: "Approve/Edit CS replies with learning loop (LlamaIndex)"
    status: TODO
    deliverables:
      - "Inbox shows draft replies (rag → approvals)"
      - "Approve: sends via Zoho; Edit: stores both machine + human text for fine-tuning"
      - "Metrics: approval rate, avg edit distance"
    deps: ["mcp.connectors-production","rag.index-optimization"]

  - id: inventory.reorder-v1
    node: inventory
    title: "Vendor-aware reorder points + SKU/vendor mapping UI"
    status: TODO
    deliverables:
      - "Lead-time demand + safety stock: ROP = μ_d * L + z * σ_d * √L"
      - "Screens: by All, Vendor, Fast Movers"
      - "Assign/remove vendors; vendor SKU mapping"
    deps: ["mcp.connectors-production"]

  - id: tooling.ops-foundation
    node: tooling
    title: "QA, CI, and deployment guardrails"
    status: TODO
    deliverables:
      - "pre-commit with black/ruff/isort"
      - "mypy on Python, tsconfig strict on dashboard"
      - "Playwright smoke test bound to `npm run test:e2e`"
      - "Docker containerization for all services with health checks"
      - "CI/CD pipeline plus artifact uploads (lint/test results)"
      - "Production health monitoring + log aggregation story"
    notes: "Owner: Tooling. Acceptance: CI green, smoke tests automated, deploy pipeline documented."

  - id: mcp.connectors-production
    node: mcp
    title: "MCP connectors live readiness"
    status: TODO
    deliverables:
      - "ENV keys validated; 401/403 handling with actionable error messages"
      - "Typed response mappers and minimal caching"
      - "Dashboard settings can mark a connector as LIVE or MOCK"
      - "Rate limiting, retry, and connection pooling policies implemented"
      - "Error tracking + alerting with performance metrics surfaced"
    notes: "Owner: MCP. Acceptance: live vitest suite green; metrics exported to /app/metrics."
    deps: ["dashboard.settings-v1"]

  - id: rag.index-optimization
    node: rag
    title: "RAG ingestion, caching, and latency tuning"
    status: TODO
    deliverables:
      - "Crawl via discover_urls.py; ingest via ingest_site_chroma.py"
      - "Corrections loaded from corrections/corrections.yaml"
      - "Golden tests pass: run `python run_goldens.py`"
      - "Chroma persistence + backup plan documented"
      - "Embedding cache configured with tuned HNSW params"
      - "p95 latency target defined and met under load harness"
    notes: "Owner: RAG. Acceptance: goldens green with load metrics attached."
    deps: ["tooling.ops-foundation"]

  - id: ops.readiness-triad
    node: tooling
    title: "Integration, QA, and Release control room"
    status: DOING
    deliverables:
      - "Integration: health_grid + monitor sweeps captured every 5 minutes with TSV artifacts"
      - "Quality: independent verification log (findings prioritized, blockers logged)"
      - "Release Ops: GO/NO-GO checklist with evidence table and rollback plan"
      - "All updates recorded using proof-of-work template; blockers escalated within 5 minutes"
    notes: "Owners: Integration, Quality, Release-Ops. Acceptance: status-dashboard.md reflects latest sweeps and checklist."

  - id: sales.mock-validation
    node: sales
    title: "Sales analytics mock-validation + SLOs"
    status: TODO
    deliverables:
      - "Vitest loaders/tests for sales routes running against mocks"
      - "CSV export tests and artifacts attached"
      - "SLO draft for availability/error/p95 captured in feedback"
      - "Mock vs live dependency tracker logged (Bing, GA4, GSC)"
    notes: "Owner: Sales. Acceptance: tests green; SLOs documented in feedback/sales.md."

  - id: seo.credentials-gating
    node: seo
    title: "SEO gating, health, and credential workflow"
    status: TODO
    deliverables:
      - "Vitest loaders/api tests for SEO routes green"
      - "Credential gating banners and connection-tests surfaced"
      - "GA4/GSC live validation evidence attached; Bing mock state noted"
      - "Metric counters exported and linked in feedback/seo.md"
    notes: "Owner: SEO. Acceptance: health endpoint 200 with proof-of-work logged."
