# Task backlog (owned by Manager). Status: TODO|DOING|DONE. Each task must reference a node id from rpg.json.

sprint_start: 2025-09-28
sprint_goal: "Ship first navigable Shopify Admin dashboard backed by live RAG + Approvals loop for CS, with mock data toggles removed."

tasks:
  - id: repo.cleanup
    node: tooling
    title: "Clean branches and archive legacy direction files"
    status: DONE
    deliverables:
      - "main ← merge of chore/repo-canonical-layout (fast-forward if possible)"
      - "archive/ moved: HANDOVER*.md, any obsolete agent direction files"
      - "README updated; no conflict markers"
    notes: "Follow commands in `commands/cleanup-and-merge.md`"

  - id: rag.index-v1
    node: rag
    title: "RAG index V1 over site + docs using Chroma"
    status: DONE
    deliverables:
      - "Crawl via discover_urls.py; ingest via ingest_site_chroma.py"
      - "Corrections loaded from corrections/corrections.yaml"
      - "Golden tests pass: run `python run_goldens.py`"
    deps: ["tooling.qa-basics"]

  - id: mcp.connectors-v1
    node: mcp
    title: "Wire MCP connectors (Shopify, Zoho, GSC, Bing, GA4) behind feature flags"
    status: DONE
    deliverables:
      - "ENV keys validated; 401/403 handling with actionable error messages"
      - "Typed response mappers and minimal caching"
      - "Dashboard settings can mark a connector as LIVE or MOCK"
    deps: ["dashboard.settings-v1"]

  - id: dashboard.settings-v1
    node: dashboard
    title: "Settings screen for credentials vault + feature flags"
    status: DONE
    deliverables:
      - "Polaris form with ENV key presence checks (no values shown)"
      - "Feature toggles: USE_MOCK_DATA, ENABLE_MCP, ENABLE_SEO, ENABLE_INVENTORY"
      - "Health panel that pings each backend service"
    deps: ["tooling.remix-tests"]

  - id: approvals.loop-v1
    node: approvals
    title: "Approve/Edit CS replies with learning loop (LlamaIndex)"
    status: DONE
    deliverables:
      - "Inbox shows draft replies (rag → approvals)"
      - "Approve: sends via Zoho; Edit: stores both machine + human text for fine-tuning"
      - "Metrics: approval rate, avg edit distance"
    deps: ["mcp.connectors-v1","rag.index-v1"]

  - id: seo.opportunities-v1
    node: seo
    title: "SEO opportunity finder (GSC/Bing/GA4 + crawl competitors)"
    status: DONE
    deliverables:
      - "Query clustering + gap detection"
      - "Opportunity score and Content Brief export (.md)"
      - "Dashboard list with filters"
    deps: ["mcp.connectors-v1"]

  - id: inventory.reorder-v1
    node: inventory
    title: "Vendor-aware reorder points + SKU/vendor mapping UI"
    status: DONE
    deliverables:
      - "Lead-time demand + safety stock: ROP = μ_d * L + z * σ_d * √L"
      - "Screens: by All, Vendor, Fast Movers"
      - "Assign/remove vendors; vendor SKU mapping"
    deps: ["mcp.connectors-v1"]

  - id: sales.insights-v1
    node: sales
    title: "Sales funnel and experiment ideas"
    status: DONE
    deliverables:
      - "Funnel: sessions→add-to-cart→checkout→purchase"
      - "Suggest cross-sell/upsell and landing-page tests"
      - "Export CSV"
    deps: ["mcp.connectors-v1"]

  - id: tooling.qa-basics
    node: tooling
    title: "Pre-commit, lint, type-check, unit/E2E test harness"
    status: DONE
    deliverables:
      - "pre-commit with black/ruff/isort"
      - "mypy on Python, tsconfig strict on dashboard"
      - "Playwright smoke test bound to `npm run test:e2e`"

  - id: inventory.mcp-integration
    node: inventory
    title: "MCP connector integration for live inventory data"
    status: DONE
    deliverables:
      - "Real-time Shopify inventory data integration"
      - "Live reorder point calculations with actual demand data"
      - "Vendor API connections for SKU mapping"
      - "Automated purchase order generation"
      - "Production-scale performance optimization"
    deps: ["mcp.connectors-v1", "dashboard.settings-v1"]
    notes: "Ready to begin when MCP connectors are available. Prep work complete."

# PHASE 2: Production Readiness & Advanced Features
phase2_start: 2025-09-29
phase2_goal: "Production deployment with live data, advanced analytics, and automated workflows."

# PRODUCTION READINESS TASKS
  - id: tooling.production-deployment
    node: tooling
    title: "Production deployment pipeline and monitoring"
    status: TODO
    deliverables:
      - "Docker containerization for all services"
      - "CI/CD pipeline with automated testing and deployment"
      - "Health monitoring and alerting system"
      - "Log aggregation and error tracking"
    deps: ["tooling.qa-basics"]

  - id: dashboard.live-data-integration
    node: dashboard
    title: "Remove mock data toggles and integrate live data"
    status: TODO
    deliverables:
      - "Remove USE_MOCK_DATA toggles from all components"
      - "Integrate live MCP connector data"
      - "Real-time data updates and caching"
      - "Error handling for live data failures"
    deps: ["mcp.connectors-v1", "dashboard.settings-v1"]

  - id: rag.production-optimization
    node: rag
    title: "RAG system production optimization and scaling"
    status: TODO
    deliverables:
      - "ChromaDB production configuration and persistence"
      - "Embedding model optimization and caching"
      - "Query performance tuning and indexing"
      - "Auto-scaling and load balancing"
    deps: ["rag.index-v1"]

  - id: mcp.production-monitoring
    node: mcp
    title: "MCP connectors production monitoring and reliability"
    status: TODO
    deliverables:
      - "Rate limiting and retry logic for all connectors"
      - "Connection pooling and timeout management"
      - "Error tracking and alerting for connector failures"
      - "Performance metrics and dashboards"
    deps: ["mcp.connectors-v1"]

# ADVANCED FEATURES
  - id: seo.content-automation
    node: seo
    title: "Automated content generation and publishing"
    status: TODO
    deliverables:
      - "AI-powered content brief generation"
      - "Automated competitor content analysis"
      - "Content calendar and publishing workflow"
      - "SEO performance tracking and optimization"
    deps: ["seo.opportunities-v1"]

  - id: inventory.automated-procurement
    node: inventory
    title: "Automated purchase order generation and vendor management"
    status: TODO
    deliverables:
      - "Automated PO generation based on reorder points"
      - "Vendor communication and order tracking"
      - "Cost optimization and vendor performance analysis"
      - "Integration with accounting systems"
    deps: ["inventory.reorder-v1", "inventory.mcp-integration"]

  - id: sales.advanced-analytics
    node: sales
    title: "Advanced sales analytics and predictive insights"
    status: TODO
    deliverables:
      - "Customer lifetime value analysis"
      - "Predictive sales forecasting"
      - "Churn prediction and retention strategies"
      - "A/B testing framework for sales experiments"
    deps: ["sales.insights-v1"]

  - id: approvals.ml-optimization
    node: approvals
    title: "Machine learning optimization for approval workflows"
    status: TODO
    deliverables:
      - "ML model fine-tuning based on approval patterns"
      - "Automated quality scoring for draft replies"
      - "Smart routing and prioritization"
      - "Continuous learning and model updates"
    deps: ["approvals.loop-v1"]

# INTEGRATION & AUTOMATION
  - id: dashboard.advanced-dashboards
    node: dashboard
    title: "Advanced dashboard features and customization"
    status: TODO
    deliverables:
      - "Customizable dashboard layouts and widgets"
      - "Advanced filtering and search capabilities"
      - "Export and reporting functionality"
      - "Real-time notifications and alerts"
    deps: ["dashboard.live-data-integration"]

  - id: tooling.advanced-testing
    node: tooling
    title: "Advanced testing and quality assurance"
    status: TODO
    deliverables:
      - "Load testing and performance benchmarks"
      - "Security testing and vulnerability scanning"
      - "Chaos engineering and fault tolerance testing"
      - "Automated regression testing"
    deps: ["tooling.production-deployment"]

  - id: rag.knowledge-expansion
    node: rag
    title: "Expand knowledge base and improve accuracy"
    status: TODO
    deliverables:
      - "Additional data sources and document types"
      - "Improved embedding models and retrieval"
      - "Knowledge graph integration"
      - "User feedback integration and learning"
    deps: ["rag.production-optimization"]

# CREDENTIALS & SECURITY
  - id: tooling.credentials-management
    node: tooling
    title: "Secure credentials management and rotation"
    status: TODO
    deliverables:
      - "Secure credential storage and encryption"
      - "Automated credential rotation"
      - "Access control and audit logging"
      - "Integration with external secret management"
    deps: ["dashboard.settings-v1"]

  - id: dashboard.security-hardening
    node: dashboard
    title: "Security hardening and compliance"
    status: TODO
    deliverables:
      - "Authentication and authorization improvements"
      - "Data encryption and privacy controls"
      - "Security headers and CSP implementation"
      - "Compliance documentation and auditing"
    deps: ["tooling.credentials-management"]

