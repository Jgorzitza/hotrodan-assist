import{r as _,j as u}from"./index-DZoorY08.js";import{u as en,L as on,a as sn,b as nn,c as Tn}from"./PolarisVizProvider-BMFajI3Y.js";import{w as rn,e as p,g as ln,c as O,h as un,j as an,k as N,L as T,m as cn,n as Cn,u as Dn,a as wn,o as On}from"./ChartContainer-DSIix7Zm.js";const Pn=.99,Fn=.59;class Gn{constructor(s,t){this.config=void 0,this._context=void 0,this._shift=void 0,this._line=void 0,this._x=void 0,this._y=void 0,this._point=void 0,this._context=s,this.config=t,this._shift=.5}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=NaN,this._y=NaN,this._point=0}lineEnd(){this._shift>0&&this._shift<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._shift=1-this._shift,this._line=1-this._line)}point(s,t){const l=Number(s),c=Number(t);switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(l,c):this._context.moveTo(l,c);break;default:{if(this._point===1&&(this._point=2),this._shift<=0)this._context.lineTo(this._x,c),this._context.lineTo(l,c);else{const a=this._x*(1-this._shift)+l*this._shift,h=(l-this._x)*(this.config.distance/2),r=this.config.roundness,i=[[a-h,this._y],[a+h,c]],o=i[1][0]-i[0][0],m=[[i[0][0]+o*r,i[0][1]],[i[1][0]-o*r,i[1][1]]];this._context.lineTo(i[0][0],i[0][1]),this._context.bezierCurveTo(m[0][0],m[0][1],m[1][0],m[1][1],i[1][0],i[1][1])}break}}this._x=l,this._y=c}}function tn(n){return new Gn(n,{distance:Pn,roundness:Fn})}function dn(n){this._context=n}dn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,s){switch(n=+n,s=+s,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break;case 1:this._point=2;default:this._context.lineTo(n,s);break}}};function fn(n){return new dn(n)}function hn(n){return n[0]}function pn(n){return n[1]}function mn(n,s){var t=p(!0),l=null,c=fn,a=null,h=rn(r);n=typeof n=="function"?n:n===void 0?hn:p(n),s=typeof s=="function"?s:s===void 0?pn:p(s);function r(i){var o,m=(i=ln(i)).length,e,d=!1,x;for(l==null&&(a=c(x=h())),o=0;o<=m;++o)!(o<m&&t(e=i[o],o,i))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+n(e,o,i),+s(e,o,i));if(x)return a=null,x+""||null}return r.x=function(i){return arguments.length?(n=typeof i=="function"?i:p(+i),r):n},r.y=function(i){return arguments.length?(s=typeof i=="function"?i:p(+i),r):s},r.defined=function(i){return arguments.length?(t=typeof i=="function"?i:p(!!i),r):t},r.curve=function(i){return arguments.length?(c=i,l!=null&&(a=c(l)),r):c},r.context=function(i){return arguments.length?(i==null?l=a=null:a=c(l=i),r):l},r}function Mn(n,s,t){var l=null,c=p(!0),a=null,h=fn,r=null,i=rn(o);n=typeof n=="function"?n:n===void 0?hn:p(+n),s=typeof s=="function"?s:s===void 0?p(0):p(+s),t=typeof t=="function"?t:t===void 0?pn:p(+t);function o(e){var d,x,v,y=(e=ln(e)).length,k,g=!1,j,I=new Array(y),L=new Array(y);for(a==null&&(r=h(j=i())),d=0;d<=y;++d){if(!(d<y&&c(k=e[d],d,e))===g)if(g=!g)x=d,r.areaStart(),r.lineStart();else{for(r.lineEnd(),r.lineStart(),v=d-1;v>=x;--v)r.point(I[v],L[v]);r.lineEnd(),r.areaEnd()}g&&(I[d]=+n(k,d,e),L[d]=+s(k,d,e),r.point(l?+l(k,d,e):I[d],t?+t(k,d,e):L[d]))}if(j)return r=null,j+""||null}function m(){return mn().defined(c).curve(h).context(a)}return o.x=function(e){return arguments.length?(n=typeof e=="function"?e:p(+e),l=null,o):n},o.x0=function(e){return arguments.length?(n=typeof e=="function"?e:p(+e),o):n},o.x1=function(e){return arguments.length?(l=e==null?null:typeof e=="function"?e:p(+e),o):l},o.y=function(e){return arguments.length?(s=typeof e=="function"?e:p(+e),t=null,o):s},o.y0=function(e){return arguments.length?(s=typeof e=="function"?e:p(+e),o):s},o.y1=function(e){return arguments.length?(t=e==null?null:typeof e=="function"?e:p(+e),o):t},o.lineX0=o.lineY0=function(){return m().x(n).y(s)},o.lineY1=function(){return m().x(n).y(t)},o.lineX1=function(){return m().x(l).y(s)},o.defined=function(e){return arguments.length?(c=typeof e=="function"?e:p(!!e),o):c},o.curve=function(e){return arguments.length?(h=e,a!=null&&(r=h(a)),o):h},o.context=function(e){return arguments.length?(e==null?a=r=null:r=h(a=e),o):a},o}function Rn({activeLineIndex:n,delay:s,fromData:t,immediate:l,index:c,isComparisonLine:a,lastY:h,lineGenerator:r,strokeDasharray:i,strokeWidth:o,toData:m,zeroLineData:e,zeroLineY:d}){const{components:{Path:x},animated:v}=O(),y=v(x),k=un({shouldAnimate:!l,animationDelay:l?0:s,mountedSpringConfig:on,unmountedSpringConfig:sn}),g=_.useRef(!1),{animatedLineShape:j}=en({from:{cy:g.current?h:d,animatedLineShape:r(g.current?t.data:e)},to:{cy:h,animatedLineShape:r(m.data)},...k});return u.jsx(_.Fragment,{children:u.jsx(y,{d:j,stroke:"white",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:o,style:{...a?{}:an({activeIndex:n,index:c}),strokeDasharray:i}})})}const bn=.25;function zn({series:{areaColor:n},areaPath:s}){const t=_.useMemo(()=>N("default-area-gradient"),[]),l=_.useMemo(()=>N("default-area-mask"),[]),{components:{Path:c,Defs:a,Mask:h},animated:r}=O(),i=r(c);return s==null||n==null?null:u.jsxs(_.Fragment,{children:[u.jsxs(a,{children:[u.jsx(h,{id:l,children:u.jsx(i,{d:s,fill:`url(#${l}-gradient)`})}),u.jsx(T,{id:`${l}-gradient`,x1:"0%",x2:"100%",y1:"0%",y2:"0%",gradient:[{offset:0,color:"black"},{offset:10,color:"white"},{offset:90,color:"white"},{offset:100,color:"black"}]}),u.jsx(T,{id:t,x1:"0%",x2:"0%",y1:"0%",y2:"100%",gradient:[{offset:0,stopOpacity:bn,color:n},{offset:100,stopOpacity:0,color:n}]})]}),u.jsx(i,{d:s,fill:`url(#${t})`,mask:`url(#${l})`,strokeWidth:"0",stroke:n,style:{pointerEvents:"none"}})]})}function Wn(n){return n==null?null:cn(n)}const $n=[{offset:20,color:"white"},{offset:100,color:"black"}];function Hn({areaPath:n,color:s}){const t=_.useMemo(()=>N("spark-area-gradient"),[]),l=_.useMemo(()=>N("spark-area-mask"),[]),c=Wn(s),{components:{Defs:a,Mask:h,Path:r},animated:i}=O(),o=i(r);return c==null?null:u.jsxs(_.Fragment,{children:[u.jsxs(a,{children:[u.jsx(h,{id:l,children:u.jsx(o,{fill:`url(#${l}-gradient)`,d:n})}),u.jsx(T,{id:`${l}-gradient`,y1:"0%",y2:"100%",gradient:$n}),u.jsx(T,{id:t,y1:"100%",y2:"0%",gradient:c})]}),u.jsx(o,{d:n,fill:`url(#${t})`,mask:`url(#${l})`,opacity:"0.2"})]})}function gn({areaPath:n,series:s,type:t}){if(s.isComparison===!0)return null;switch(t){case"spark":return u.jsx(Hn,{color:s.color,areaPath:n});default:case"default":return u.jsx(zn,{series:s,areaPath:n})}}function Un({immediate:n,fromData:s,toData:t,zeroLineData:l,delay:c,areaGenerator:a,type:h}){const r=_.useRef(!1),i=un({shouldAnimate:!n,animationDelay:n?0:c,mountedSpringConfig:on,unmountedSpringConfig:sn}),{animatedLineShape:o}=en({from:{animatedLineShape:a(r.current?s.data:l)},to:{animatedLineShape:a(t.data)},...i});return u.jsx(gn,{areaPath:o,series:t,type:h})}const Yn=200,Vn=1.5;function Bn({activeLineIndex:n=-1,animationDelay:s,data:t,hiddenIndexes:l=[],index:c=0,svgDimensions:a,theme:h,type:r="default",xScale:i,yScale:o,shouldShowArea:m=!0}){var e,d,x,v,y,k;const g=(e=t==null||(d=t.metadata)===null||d===void 0?void 0:d.relatedIndex)!==null&&e!==void 0?e:c,{components:{Defs:j,Mask:I,G:L,Rect:xn,Path:W},animated:_n}=O(),S=Cn(t),{shouldAnimate:vn,comparisonIndexes:$}=Dn(),kn=_n(L),H=t==null?void 0:t.color,P=wn(h),yn=r==="spark",F=mn().x((f,A)=>i==null?0:i(A)).y(({value:f})=>o(f??0)).defined(({value:f})=>f!=null),G=Mn().x((f,A)=>i(A)).y0(a.height).y1(({value:f})=>o(f??0)).defined(({value:f})=>f!=null);P.line.hasSpline&&(F.curve(tn),G.curve(tn));const M=F(t.data),[E]=t.data.filter(({value:f})=>f!=null).slice(-1),R=(E==null?void 0:E.value)!=null?{x:i(t.data.indexOf(E)),y:o(E.value)}:null,U=G(t.data),C=_.useMemo(()=>N("line-series"),[]),b=!vn,An=cn(H),Y=$.length>1,z=t.isComparison===!0||$.includes(g),jn=s??g*Yn,V=b||z?0:jn,K=f=>f==null?void 0:f.data.some(({value:A})=>A==null),X=!K(t)&&!K(S)&&t.data.length===(S==null?void 0:S.data.length),{y:Ln=0}=R??{},q=t.data.map(f=>({...f,value:f.value===null?null:0}));if(M==null||U==null)return null;const D=yn?Vn:(x=t.width)!==null&&x!==void 0?x:P.line.width,B=(v=t.strokeDasharray)!==null&&v!==void 0?v:"none",Sn=15,In=P.line.hasArea&&(t==null||(y=t.styleOverride)===null||y===void 0||(k=y.line)===null||k===void 0?void 0:k.hasArea)!==!1&&m,En=o(0),Nn=f=>{const A=[];return f.data.forEach((J,w)=>{const Q=f.data[w-1],Z=f.data[w+1];J.value!==null&&(!Q||Q.value===null)&&(!Z||Z.value===null)&&A.push(u.jsx("circle",{cx:i(w),cy:o(J.value),r:1,fill:String(H)},w))}),A};return u.jsx(_.Fragment,{children:u.jsxs(kn,{opacity:1,style:{display:l.includes(g)?"none":void 0},children:[u.jsxs(j,{children:[u.jsx(T,{id:`line-${C}`,gradient:An,gradientUnits:"userSpaceOnUse",y1:"100%",y2:"0%"}),u.jsx(I,{id:`mask-${C}`,children:u.jsx(L,{style:{...Y?{}:an({activeIndex:n,index:g})},children:X?u.jsx(Rn,{activeLineIndex:n,delay:V,fromData:S,immediate:b,index:g,isComparisonLine:z,lastY:Ln,lineGenerator:F,strokeDasharray:B,strokeWidth:D,toData:t,zeroLineData:q,zeroLineY:En}):u.jsx(_.Fragment,{children:u.jsx(W,{d:M,stroke:"white",strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:D,style:{strokeDasharray:B,strokeLinecap:"round"}})})})})]}),In&&(X?u.jsx(Un,{areaGenerator:G,fromData:S,toData:t,zeroLineData:q,type:r,delay:V,immediate:b}):u.jsx(gn,{series:t,areaPath:U,type:r})),u.jsx(xn,{x:"0",y:(D+nn)*-1,width:a.width,height:a.height+D*2+nn,fill:`url(#line-${C})`,mask:`url(#mask-${`${C}`})`,style:{pointerEvents:"none"}}),t.isComparison&&Nn(t),u.jsx(W,{d:M,strokeWidth:Sn,stroke:"transparent",fill:"none",...On({type:Tn,index:g}),style:{pointerEvents:Y&&z?"none":"auto"}})]})})}export{Bn as L,tn as c,mn as l};
