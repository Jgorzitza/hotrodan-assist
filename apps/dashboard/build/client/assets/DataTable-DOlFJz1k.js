import{R as a,r as L}from"./index-DZoorY08.js";import{i as le}from"./index-1GQyLQny.js";import{h as J,d as se,E as X}from"./context-CVB7tZr2.js";import{n as K,f as D,v as ae,o as ie,i as ne,B as Y,p as oe,q as re,r as ce}from"./Page-CO1VPtMw.js";import{S as de,a as ue,A as he}from"./AfterInitialMount-C-VclerA.js";import{S as me}from"./Sticky-3Wxpi6V4.js";function fe(C){return function(h,t){const{firstVisibleColumnIndex:e,tableLeftVisibleEdge:l,tableRightVisibleEdge:s}=C,r=h.offsetLeft,c=r+h.offsetWidth,n=ee(r,l,s,"left"),o=ee(c,l,s,"right"),d=n||o,u=h.offsetWidth;return d&&(C.firstVisibleColumnIndex=Math.min(e,t)),{leftEdge:r,rightEdge:c,isVisible:d,width:u,index:t}}}function ee(C,h,t,e){return C>=h+(e==="left"?0:30)&&C<=t-30}function be(C,h){const{firstVisibleColumnIndex:t}=C,e=Math.max(t-1,0),l=h[e],s=h[t];return{previousColumn:l,currentColumn:s}}var i={DataTable:"Polaris-DataTable",condensed:"Polaris-DataTable--condensed",Navigation:"Polaris-DataTable__Navigation",Pip:"Polaris-DataTable__Pip","Pip-visible":"Polaris-DataTable__Pip--visible",ScrollContainer:"Polaris-DataTable__ScrollContainer",Table:"Polaris-DataTable__Table",TableRow:"Polaris-DataTable__TableRow",Cell:"Polaris-DataTable__Cell",IncreasedTableDensity:"Polaris-DataTable__IncreasedTableDensity",ZebraStripingOnData:"Polaris-DataTable__ZebraStripingOnData",RowCountIsEven:"Polaris-DataTable__RowCountIsEven",ShowTotalsInFooter:"Polaris-DataTable__ShowTotalsInFooter","Cell-separate":"Polaris-DataTable__Cell--separate","Cell-firstColumn":"Polaris-DataTable__Cell--firstColumn","Cell-numeric":"Polaris-DataTable__Cell--numeric","Cell-truncated":"Polaris-DataTable__Cell--truncated","Cell-header":"Polaris-DataTable__Cell--header","Cell-sortable":"Polaris-DataTable__Cell--sortable","Heading-left":"Polaris-DataTable__Heading--left","Cell-verticalAlignTop":"Polaris-DataTable__Cell--verticalAlignTop","Cell-verticalAlignBottom":"Polaris-DataTable__Cell--verticalAlignBottom","Cell-verticalAlignMiddle":"Polaris-DataTable__Cell--verticalAlignMiddle","Cell-verticalAlignBaseline":"Polaris-DataTable__Cell--verticalAlignBaseline",hoverable:"Polaris-DataTable--hoverable","Cell-hovered":"Polaris-DataTable__Cell--hovered",Icon:"Polaris-DataTable__Icon",Heading:"Polaris-DataTable__Heading",StickyHeaderEnabled:"Polaris-DataTable__StickyHeaderEnabled",StickyHeaderWrapper:"Polaris-DataTable__StickyHeaderWrapper","Cell-sorted":"Polaris-DataTable__Cell--sorted","Cell-total":"Polaris-DataTable__Cell--total",ShowTotals:"Polaris-DataTable__ShowTotals","Cell-total-footer":"Polaris-DataTable--cellTotalFooter",Footer:"Polaris-DataTable__Footer",StickyHeaderInner:"Polaris-DataTable__StickyHeaderInner","StickyHeaderInner-isSticky":"Polaris-DataTable__StickyHeaderInner--isSticky",StickyHeaderTable:"Polaris-DataTable__StickyHeaderTable",FixedFirstColumn:"Polaris-DataTable__FixedFirstColumn",StickyTableHeadingsRow:"Polaris-DataTable__StickyTableHeadingsRow",TooltipContent:"Polaris-DataTable__TooltipContent"};function A({content:C,contentType:h,nthColumn:t,firstColumn:e,truncate:l,header:s,total:r,totalInFooter:c,sorted:n,sortable:o,sortDirection:d,inFixedNthColumn:u,verticalAlign:m="top",defaultSortDirection:f="ascending",onSort:g,colSpan:y,setRef:T=()=>{},stickyHeadingCell:E=!1,stickyCellWidth:_,hovered:N=!1,handleFocus:k=()=>{},hasFixedNthColumn:P=!1,fixedCellVisible:w=!1,firstColumnMinWidth:F,style:v,lastFixedFirstColumn:S}){const R=K(),V=h==="numeric",x=D(i.Cell,i[`Cell-${ae("verticalAlign",m)}`],e&&i["Cell-firstColumn"],l&&i["Cell-truncated"],s&&i["Cell-header"],r&&i["Cell-total"],c&&i["Cell-total-footer"],V&&i["Cell-numeric"],o&&i["Cell-sortable"],n&&i["Cell-sorted"],E&&i.StickyHeaderCell,N&&i["Cell-hovered"],S&&u&&w&&i["Cell-separate"],t&&u&&E&&i.FixedFirstColumn),O=D(s&&i.Heading,s&&h==="text"&&i["Heading-left"]),$=D(o&&i.Icon),W=n&&d?d:f,B=W==="descending"?de:ue,j=d==="ascending"?"descending":"ascending",q=R.translate("Polaris.DataTable.sortAccessibilityLabel",{direction:n?j:W}),M=a.createElement("span",{className:$},a.createElement(ne,{source:B,accessibilityLabel:q})),z=!(E&&P&&t&&!u),I=o?a.createElement("button",{className:O,onClick:g,onFocus:k,tabIndex:z?0:-1},M,C):C,H=y&&y>1?{colSpan:y}:{},b=t&&F?{minWidth:F}:{minWidth:_},p=a.createElement("th",Object.assign({ref:T},J.props,H,{className:x,"aria-sort":d,style:{...v,...b},"data-index-table-sticky-heading":!0}),I),U=s?a.createElement("th",Object.assign({},J.props,{"aria-sort":d},H,{ref:T,className:x,scope:"col",style:{...b}}),I):a.createElement("th",Object.assign({},H,{ref:T,className:x,scope:"row",style:{...b}}),l?a.createElement(Ce,{className:i.TooltipContent},C):C),G=s||e||t?U:a.createElement("td",Object.assign({className:x},H),C);return E?p:G}const Ce=({children:C,className:h=""})=>{const t=L.useRef(null),{current:e}=t,l=a.createElement("span",{ref:t,className:h},C);return(e==null?void 0:e.scrollWidth)>(e==null?void 0:e.offsetWidth)?a.createElement(ie,{content:t.current.innerText},l):l};function ge({columnVisibilityData:C,isScrolledFarthestLeft:h,isScrolledFarthestRight:t,navigateTableLeft:e,navigateTableRight:l,fixedFirstColumns:s,setRef:r=()=>{}}){const c=K(),n=C.map((u,m)=>{if(m<s)return;const f=D(i.Pip,u.isVisible&&i["Pip-visible"]);return a.createElement("div",{className:f,key:`pip-${m}`})}),o=c.translate("Polaris.DataTable.navAccessibilityLabel",{direction:"left"}),d=c.translate("Polaris.DataTable.navAccessibilityLabel",{direction:"right"});return a.createElement("div",{className:i.Navigation,ref:r},a.createElement(Y,{variant:"tertiary",icon:oe,disabled:h,accessibilityLabel:o,onClick:e}),n,a.createElement(Y,{variant:"tertiary",icon:re,disabled:t,accessibilityLabel:d,onClick:l}))}const te=C=>{const h=[];return C&&C.forEach(t=>{h.push(t.clientHeight)}),h};class pe extends L.PureComponent{constructor(...h){super(...h),this.state={condensed:!1,columnVisibilityData:[],isScrolledFarthestLeft:!0,isScrolledFarthestRight:!1,rowHovered:void 0},this.dataTable=L.createRef(),this.scrollContainer=L.createRef(),this.table=L.createRef(),this.stickyTable=L.createRef(),this.stickyNav=null,this.headerNav=null,this.tableHeadings=[],this.stickyHeadings=[],this.tableHeadingWidths=[],this.stickyHeaderActive=!1,this.scrollStopTimer=null,this.handleResize=se(()=>{const{table:{current:t},scrollContainer:{current:e}}=this;let l=!1;t&&e&&(l=t.scrollWidth>e.clientWidth+1),this.setState({condensed:l,...this.calculateColumnVisibilityData(l)})}),this.setCellRef=({ref:t,index:e,inStickyHeader:l})=>{if(t!=null)if(l){this.stickyHeadings[e]=t;const s=t.querySelector("button");if(s==null)return;s.addEventListener("focus",this.handleHeaderButtonFocus)}else this.tableHeadings[e]=t,this.tableHeadingWidths[e]=t.clientWidth},this.changeHeadingFocus=()=>{const{tableHeadings:t,stickyHeadings:e,stickyNav:l,headerNav:s}=this,r=e.findIndex(f=>{var g;return f===((g=document.activeElement)==null?void 0:g.parentElement)}),c=t.findIndex(f=>{var g;return f===((g=document.activeElement)==null?void 0:g.parentElement)}),n=l==null?void 0:l.querySelectorAll("button"),o=s==null?void 0:s.querySelectorAll("button");let d=-1;n==null||n.forEach((f,g)=>{f===document.activeElement&&(d=g)});let u=-1;if(o==null||o.forEach((f,g)=>{f===document.activeElement&&(u=g)}),r<0&&c<0&&d<0&&u<0)return null;let m;if(r>=0?m=t[r].querySelector("button"):c>=0&&(m=e[c].querySelector("button")),d>=0?m=o==null?void 0:o[d]:u>=0&&(m=n==null?void 0:n[u]),m==null)return null;m.style.visibility="visible",m.focus(),m.style.removeProperty("visibility")},this.calculateColumnVisibilityData=t=>{const e=this.fixedFirstColumns(),{table:{current:l},scrollContainer:{current:s},dataTable:{current:r}}=this,{stickyHeader:c}=this.props;if((c||t)&&l&&s&&r){const n=l.querySelectorAll(J.selector),o=n[e-1],d=e?o.offsetLeft+o.offsetWidth:0;if(n.length>0){const u=n.length-1,m=s.scrollLeft+d,f=s.scrollLeft+r.offsetWidth,g={firstVisibleColumnIndex:u,tableLeftVisibleEdge:m,tableRightVisibleEdge:f},y=[...n].map(fe(g)),T=y[y.length-1],E=e?m===d:m===0;return{columnVisibilityData:y,...be(g,y),isScrolledFarthestLeft:E,isScrolledFarthestRight:T.rightEdge<=f}}}return{columnVisibilityData:[],previousColumn:void 0,currentColumn:void 0}},this.handleHeaderButtonFocus=t=>{var m;const e=this.fixedFirstColumns();if(this.scrollContainer.current==null||t.target==null||this.state.columnVisibilityData.length===0)return;const s=t.target.parentNode,r=this.scrollContainer.current.scrollLeft,c=this.scrollContainer.current.offsetWidth,n=r+c,o=this.state.columnVisibilityData.length>0?(m=this.state.columnVisibilityData[e])==null?void 0:m.rightEdge:0,d=s.offsetLeft,u=s.offsetLeft+s.offsetWidth;r>d-o&&(this.scrollContainer.current.scrollLeft=d-o),u>n&&(this.scrollContainer.current.scrollLeft=u-c)},this.stickyHeaderScrolling=()=>{const{current:t}=this.stickyTable,{current:e}=this.scrollContainer;t==null||e==null||(t.scrollLeft=e.scrollLeft)},this.scrollListener=()=>{var t;this.scrollStopTimer&&clearTimeout(this.scrollStopTimer),this.scrollStopTimer=setTimeout(()=>{this.setState(e=>({...this.calculateColumnVisibilityData(e.condensed)}))},100),this.setState({isScrolledFarthestLeft:((t=this.scrollContainer.current)==null?void 0:t.scrollLeft)===0}),this.props.stickyHeader&&this.stickyHeaderActive&&this.stickyHeaderScrolling()},this.handleHover=t=>()=>{this.setState({rowHovered:t})},this.handleFocus=t=>{var o;const e=this.fixedFirstColumns();if(this.scrollContainer.current==null||t.target==null)return;const l=t.target.parentNode,r=this.props?(o=this.state.columnVisibilityData[e])==null?void 0:o.rightEdge:0,n=l.offsetLeft-r;this.scrollContainer.current.scrollLeft>n&&(this.scrollContainer.current.scrollLeft=n)},this.navigateTable=t=>{var d;const e=this.fixedFirstColumns(),{currentColumn:l,previousColumn:s}=this.state,r=(d=this.state.columnVisibilityData[e-1])==null?void 0:d.rightEdge;if(!l||!s)return;let c=0;for(let u=0;u<l.index;u++)c+=this.state.columnVisibilityData[u].width;const{current:n}=this.scrollContainer;return()=>{let u=0;e?u=t==="right"?c-r+l.width:c-s.width-r:u=t==="right"?l.rightEdge:s.leftEdge,n&&(n.scrollLeft=u,requestAnimationFrame(()=>{this.setState(m=>({...this.calculateColumnVisibilityData(m.condensed)}))}))}},this.renderHeading=({heading:t,headingIndex:e,inFixedNthColumn:l,inStickyHeader:s})=>{var v;const{sortable:r,truncate:c=!1,columnContentTypes:n,defaultSortDirection:o,initialSortColumnIndex:d=0,verticalAlign:u,firstColumnMinWidth:m}=this.props,f=this.fixedFirstColumns(),{sortDirection:g=o,sortedColumnIndex:y=d,isScrolledFarthestLeft:T}=this.state;let E;const _=`heading-cell-${e}`,N=`stickyheader-${e}`,k=s?N:_;if(r){const S=r[e],R=S&&y===e;E={defaultSortDirection:o,sorted:R,sortable:S,sortDirection:R?g:"none",onSort:this.defaultOnSort(e),fixedNthColumn:f,inFixedNthColumn:f}}const P=s?this.tableHeadingWidths[e]:void 0,w=!T,F={header:!0,stickyHeadingCell:s,content:t,contentType:n[e],nthColumn:e<f,fixedFirstColumns:f,truncate:c,headingIndex:e,...E,verticalAlign:u,handleFocus:this.handleFocus,stickyCellWidth:P,fixedCellVisible:w,firstColumnMinWidth:m};return l&&s?[a.createElement(A,Object.assign({key:k},F,{setRef:S=>{this.setCellRef({ref:S,index:e,inStickyHeader:s})},inFixedNthColumn:!1})),a.createElement(A,Object.assign({key:`${k}-sticky`},F,{setRef:S=>{this.setCellRef({ref:S,index:e,inStickyHeader:s})},inFixedNthColumn:!!f,lastFixedFirstColumn:e===f-1,style:{left:(v=this.state.columnVisibilityData[e])==null?void 0:v.leftEdge}}))]:a.createElement(A,Object.assign({key:k},F,{setRef:S=>{this.setCellRef({ref:S,index:e,inStickyHeader:s})},lastFixedFirstColumn:e===f-1,inFixedNthColumn:l}))},this.totalsRowHeading=()=>{const{i18n:t,totals:e,totalsName:l}=this.props,s=l||{singular:t.translate("Polaris.DataTable.totalRowHeading"),plural:t.translate("Polaris.DataTable.totalsRowHeading")};return e&&e.filter(r=>r!=="").length>1?s.plural:s.singular},this.renderTotals=({total:t,index:e})=>{const l=this.fixedFirstColumns(),s=`totals-cell-${e}`,{truncate:r=!1,verticalAlign:c,columnContentTypes:n}=this.props;let o,d;e===0&&(o=this.totalsRowHeading()),t!==""&&e>0&&(d=n[e],o=t);const u=this.props.showTotalsInFooter;return a.createElement(A,{total:!0,totalInFooter:u,nthColumn:e<=l-1,firstColumn:e===0,key:s,content:o,contentType:d,truncate:r,verticalAlign:c})},this.getColSpan=(t,e,l,s)=>{if(this.fixedFirstColumns())return 1;const c=t||1,n=e||l,o=Math.floor(n/c),d=n%c;return s===0?o+d:o},this.defaultRenderRow=({row:t,index:e,inFixedNthColumn:l,rowHeights:s})=>{const{columnContentTypes:r,truncate:c=!1,verticalAlign:n,hoverable:o=!0,headings:d}=this.props,{condensed:u}=this.state,m=this.fixedFirstColumns(),f=D(i.TableRow,o&&i.hoverable);return a.createElement("tr",{key:`row-${e}`,className:f,onMouseEnter:this.handleHover(e),onMouseLeave:this.handleHover()},t.map((g,y)=>{const T=e===this.state.rowHovered,E=`cell-${y}-row-${e}`,_=this.getColSpan(t.length,d.length,r.length,y);return a.createElement(A,{key:E,content:g,contentType:r[y],nthColumn:y<=m-1,firstColumn:y===0,truncate:c,verticalAlign:n,colSpan:_,hovered:T,style:s?{height:`${s[e]}px`}:{},inFixedNthColumn:u&&l})}))},this.defaultOnSort=t=>{const{onSort:e,defaultSortDirection:l="ascending",initialSortColumnIndex:s}=this.props,{sortDirection:r=l,sortedColumnIndex:c=s}=this.state;let n=l;return c===t&&(n=r==="ascending"?"descending":"ascending"),()=>{this.setState({sortDirection:n,sortedColumnIndex:t},()=>{e&&e(t,n)})}}}componentDidMount(){this.handleResize()}componentDidUpdate(h){le(h,this.props)||this.handleResize()}componentWillUnmount(){this.handleResize.cancel()}render(){var Z,I,H;const{headings:h,totals:t,showTotalsInFooter:e,rows:l,footerContent:s,hideScrollIndicator:r=!1,increasedTableDensity:c=!1,hasZebraStripingOnData:n=!1,stickyHeader:o=!1,hasFixedFirstColumn:d=!1,pagination:u}=this.props,{condensed:m,columnVisibilityData:f,isScrolledFarthestLeft:g,isScrolledFarthestRight:y}=this.state,T=this.fixedFirstColumns(),E=l.length%2===0,_=D(i.DataTable,m&&i.condensed,t&&i.ShowTotals,e&&i.ShowTotalsInFooter,n&&i.ZebraStripingOnData,n&&E&&i.RowCountIsEven),N=D(i.TableWrapper,m&&i.condensed,c&&i.IncreasedTableDensity,o&&i.StickyHeaderEnabled),k=a.createElement("tr",null,h.map((b,p)=>this.renderHeading({heading:b,headingIndex:p,inFixedNthColumn:!1,inStickyHeader:!1}))),P=t?a.createElement("tr",null,t.map((b,p)=>this.renderTotals({total:b,index:p}))):null,w=l.map(b=>b.slice(0,T)),F=h.slice(0,T),v=t==null?void 0:t.slice(0,T),S=(Z=this.table.current)==null?void 0:Z.children[0].childNodes,R=(I=this.table.current)==null?void 0:I.children[1].childNodes,V=te(S),x=te(R),O=m&&T!==0&&a.createElement("table",{className:D(i.FixedFirstColumn,!g&&i.separate),style:{width:`${(H=f[T-1])==null?void 0:H.rightEdge}px`}},a.createElement("thead",null,a.createElement("tr",{style:{height:`${V[0]}px`}},F.map((b,p)=>this.renderHeading({heading:b,headingIndex:p,inFixedNthColumn:!0,inStickyHeader:!1}))),t&&!e&&a.createElement("tr",{style:{height:`${V[1]}px`}},v==null?void 0:v.map((b,p)=>this.renderTotals({total:b,index:p})))),a.createElement("tbody",null,w.map((b,p)=>this.defaultRenderRow({row:b,index:p,inFixedNthColumn:!0,rowHeights:x}))),t&&e&&a.createElement("tfoot",null,a.createElement("tr",null,v==null?void 0:v.map((b,p)=>this.renderTotals({total:b,index:p}))))),$=l.map((b,p)=>this.defaultRenderRow({row:b,index:p,inFixedNthColumn:!1})),W=s?a.createElement("div",{className:i.Footer},s):null,B=u?a.createElement(ce,Object.assign({type:"table"},u)):null,j=e?null:P,q=e?a.createElement("tfoot",null,P):null,M=b=>r?null:a.createElement(ge,{columnVisibilityData:f,isScrolledFarthestLeft:g,isScrolledFarthestRight:y,navigateTableLeft:this.navigateTable("left"),navigateTableRight:this.navigateTable("right"),fixedFirstColumns:T,setRef:p=>{b==="header"?this.headerNav=p:b==="sticky"&&(this.stickyNav=p)}}),z=o?a.createElement(he,null,a.createElement("div",{className:i.StickyHeaderWrapper,role:"presentation"},a.createElement(me,{boundingElement:this.dataTable.current,onStickyChange:b=>{this.changeHeadingFocus(),this.stickyHeaderActive=b}},b=>{const p=D(i.StickyHeaderInner,b&&i["StickyHeaderInner-isSticky"]),U=D(i.StickyHeaderTable,!g&&i.separate);return a.createElement("div",{className:p},a.createElement("div",null,M("sticky")),a.createElement("table",{className:U,ref:this.stickyTable},a.createElement("thead",null,a.createElement("tr",{className:i.StickyTableHeadingsRow},h.map((G,Q)=>this.renderHeading({heading:G,headingIndex:Q,inFixedNthColumn:!!(Q<=T-1&&T),inStickyHeader:!0}))))))}))):null;return a.createElement("div",{className:N,ref:this.dataTable},z,M("header"),a.createElement("div",{className:_},a.createElement("div",{className:i.ScrollContainer,ref:this.scrollContainer},a.createElement(X,{event:"resize",handler:this.handleResize}),a.createElement(X,{capture:!0,passive:!0,event:"scroll",handler:this.scrollListener}),O,a.createElement("table",{className:i.Table,ref:this.table},a.createElement("thead",null,k,j),a.createElement("tbody",null,$),q)),B,W))}fixedFirstColumns(){const{hasFixedFirstColumn:h,fixedFirstColumns:t=0,headings:e}=this.props,l=h&&!t?1:t;return l>=e.length?0:l}}function Fe(C){const h=K();return a.createElement(pe,Object.assign({},C,{i18n:h}))}export{Fe as D};
