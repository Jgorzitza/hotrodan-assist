import{r as m,j as e}from"./index-DZoorY08.js";import{u as T,b as F}from"./components-CTA1UUXK.js";import{u as K}from"./use-index-resource-state-7IuosbnD.js";import{P as B}from"./PolarisVizProvider-BMFajI3Y.js";import{P as A,b as l,C as o,T as n,e as I,I as u,c as b,B as x}from"./Page-CO1VPtMw.js";import{T as E}from"./TitleBar-DFMSJ8Yc.js";import{B as p}from"./Banner-DCanv2aO.js";import{L as d}from"./Layout-Drv8ZkBJ.js";import{D as S}from"./Divider-DdX0k3iD.js";import{E as C}from"./EmptyState-by-HQyrj.js";import{B as N}from"./BarChart-BTH-R0IZ.js";import{D as R}from"./DataTable-DOlFJz1k.js";import{I as a}from"./IndexTable-nycHw1tK.js";import"./context-CVB7tZr2.js";import"./EmptySearchResult-D4D1_l9z.js";import"./Checkbox-drAGhQ4I.js";import"./SkipLink-CU7_6Q_C.js";import"./ChartContainer-DSIix7Zm.js";import"./index-1GQyLQny.js";import"./AfterInitialMount-C-VclerA.js";import"./Sticky-3Wxpi6V4.js";const j=(i,c)=>new Intl.NumberFormat("en-US",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(i),r=i=>new Intl.NumberFormat("en-US").format(Math.round(i)),P=i=>i<=2?"critical":i<=4?"warning":i<=7?"info":"success";function le(){const{payload:i,useMockData:c,scenario:g}=T();F();const[s,y]=m.useState(null),{selectedResources:v,allResourcesSelected:M,handleSelectionChange:V}=K(i.skus),f=m.useMemo(()=>i.deciles.length===0?[]:[{name:"Velocity by Decile",data:i.deciles.map(t=>({key:`Decile ${t.decile}`,value:t.averageVelocity}))}],[i.deciles]),D=i.deciles.map(t=>[`Decile ${t.decile}`,r(t.minVelocity),r(t.maxVelocity),r(t.averageVelocity),r(t.skuCount),j(t.totalValue.amount,t.totalValue.currency)]),h=m.useMemo(()=>s?i.skus.filter(t=>s.skuIds.includes(t.id)):i.skus,[i.skus,s]),w=t=>{y(t)},U=t=>{console.log(`Exporting decile ${t.decile}`)};return e.jsx(B,{children:e.jsxs(A,{title:"Fast Movers",subtitle:"Analyze SKU velocity patterns and identify high-performing inventory.",children:[e.jsx(E,{title:"Fast Movers",primaryAction:{content:"Export all",url:"#"}}),e.jsxs(l,{gap:"400",children:[(c||i.alert||i.error)&&e.jsxs(l,{gap:"200",children:[c&&e.jsx(p,{tone:g==="warning"?"warning":"info",title:`Mock state: ${g}`,children:e.jsx("p",{children:"Append `?mockState=warning` (etc) to explore alternate datasets."})}),i.alert&&!i.error&&e.jsx(p,{tone:"warning",title:"Fast Movers alert",children:e.jsx("p",{children:i.alert})}),i.error&&e.jsx(p,{tone:"critical",title:"Fast Movers data unavailable",children:e.jsx("p",{children:i.error})})]}),e.jsx(d,{children:e.jsx(d.Section,{children:e.jsxs(o,{children:[e.jsx(o.Section,{children:e.jsx(n,{variant:"headingMd",as:"h2",children:"Velocity Deciles"})}),e.jsx(S,{}),e.jsx(o.Section,{children:i.deciles.length===0?e.jsx(C,{heading:"No velocity data available",image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"Sync inventory data to populate Fast Movers analysis."})}):e.jsxs(l,{gap:"300",children:[f.length>0&&e.jsx(I,{padding:"300",background:"bg-subdued",borderRadius:"200",children:e.jsx("div",{style:{height:300},children:e.jsx(N,{data:f,isAnimated:!1,accessibilityLabel:"SKU velocity by decile",yAxisOptions:{labelFormatter:t=>r(Number(t))}})})}),e.jsx(R,{columnContentTypes:["text","numeric","numeric","numeric","numeric","text"],headings:["Decile","Min velocity","Max velocity","Avg velocity","SKU count","Total value"],rows:D}),e.jsx(u,{gap:"200",wrap:!0,children:i.deciles.map(t=>e.jsx(o,{sectioned:!0,background:(s==null?void 0:s.decile)===t.decile?"bg-selected":void 0,children:e.jsxs(l,{gap:"200",children:[e.jsxs(u,{align:"space-between",blockAlign:"center",children:[e.jsxs(b,{tone:P(t.decile),children:["Decile ",t.decile]}),e.jsx(x,{size:"slim",onClick:()=>U(t),children:"Export"})]}),e.jsxs(l,{gap:"100",children:[e.jsx(n,{variant:"bodySm",tone:"subdued",as:"span",children:"Velocity range"}),e.jsxs(n,{variant:"bodyMd",as:"span",children:[r(t.minVelocity)," - ",r(t.maxVelocity)]})]}),e.jsxs(l,{gap:"100",children:[e.jsx(n,{variant:"bodySm",tone:"subdued",as:"span",children:"SKUs"}),e.jsx(n,{variant:"bodyMd",as:"span",children:r(t.skuCount)})]}),e.jsxs(l,{gap:"100",children:[e.jsx(n,{variant:"bodySm",tone:"subdued",as:"span",children:"Total value"}),e.jsx(n,{variant:"bodyMd",as:"span",children:j(t.totalValue.amount,t.totalValue.currency)})]}),e.jsx(x,{size:"slim",onClick:()=>w(t),pressed:(s==null?void 0:s.decile)===t.decile,children:(s==null?void 0:s.decile)===t.decile?"Selected":"View SKUs"})]})},t.decile))})]})})]})})}),s&&e.jsx(d,{children:e.jsx(d.Section,{children:e.jsxs(o,{children:[e.jsx(o.Section,{children:e.jsxs(u,{align:"space-between",blockAlign:"center",children:[e.jsxs(n,{variant:"headingMd",as:"h2",children:["SKUs in Decile ",s.decile]}),e.jsx(x,{onClick:()=>y(null),children:"Close"})]})}),e.jsx(S,{}),e.jsx(o.Section,{children:h.length===0?e.jsx(C,{heading:"No SKUs in this decile",image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"This decile contains no SKUs."})}):e.jsx(a,{resourceName:{singular:"SKU",plural:"SKUs"},itemCount:h.length,selectedItemsCount:M?"All":v.length,onSelectionChange:V,headings:[{title:"SKU"},{title:"Title"},{title:"Vendor"},{title:"Velocity"},{title:"On hand"},{title:"Unit cost"},{title:"Status"}],children:h.map((t,k)=>e.jsxs(a.Row,{id:t.id,position:k,selected:v.includes(t.id),children:[e.jsx(a.Cell,{children:t.sku}),e.jsx(a.Cell,{children:t.title}),e.jsx(a.Cell,{children:t.vendorName}),e.jsx(a.Cell,{children:e.jsxs(l,{gap:"050",children:[e.jsxs(n,{variant:"bodyMd",as:"span",children:[r(t.velocity.lastWeekUnits)," units"]}),e.jsxs(n,{variant:"bodySm",tone:"subdued",as:"span",children:[t.velocity.turnoverDays," days turnover"]})]})}),e.jsx(a.Cell,{children:r(t.onHand)}),e.jsx(a.Cell,{children:j(t.unitCost.amount,t.unitCost.currency)}),e.jsx(a.Cell,{children:e.jsx(b,{tone:t.status==="healthy"?"success":"warning",children:t.status})})]},t.id))})})]})})})]})]})})}export{le as default};
